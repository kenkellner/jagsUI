<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Posterior Predictive Checks for Bayesian Analyses fit in JAGS — pp.check • jagsUI</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Posterior Predictive Checks for Bayesian Analyses fit in JAGS — pp.check"><meta property="og:description" content="A simple interface for generating a posterior predictive check plot for a JAGS analysis fit using jagsUI, based on the posterior distributions of discrepency metrics specified by the user and calculated and returned by JAGS (for example, sums of residuals). The user supplies the name of the discrepancy metric calculated for the real data in the argument observed, and the corresponding discrepancy for data simulated by the model in argument simulated. The posterior distributions of the two parameters will be plotted in X-Y space and a Bayesian p-value calculated."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jagsUI</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.6.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/jagsUI.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/kenkellner/jagsUI/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Posterior Predictive Checks for Bayesian Analyses fit in JAGS</h1>

    <div class="hidden name"><code>ppcheck.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A simple interface for generating a posterior predictive check plot for a JAGS analysis fit using jagsUI, based on the posterior distributions of discrepency metrics specified by the user and calculated and returned by JAGS (for example, sums of residuals). The user supplies the name of the discrepancy metric calculated for the real data in the argument <code>observed</code>, and the corresponding discrepancy for data simulated by the model in argument <code>simulated</code>. The posterior distributions of the two parameters will be plotted in X-Y space and a Bayesian p-value calculated.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pp.check</span><span class="op">(</span><span class="va">x</span>, <span class="va">observed</span>, <span class="va">simulated</span>, xlab<span class="op">=</span><span class="st">'Observed data'</span>, ylab<span class="op">=</span><span class="st">'Simulated data'</span>, </span>
<span>                     main<span class="op">=</span><span class="st">'Posterior Predictive Check'</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A jagsUI object generated using the <code>jags</code> function</p></dd>

  <dt id="arg-observed">observed<a class="anchor" aria-label="anchor" href="#arg-observed"></a></dt>
<dd><p>The name of the parameter (as a string) representing the fit of the observed data (e.g. residuals)</p></dd>

  <dt id="arg-simulated">simulated<a class="anchor" aria-label="anchor" href="#arg-simulated"></a></dt>
<dd><p>The name of the corresponding parameter (as a string) representing the fit of the new simulated data</p></dd>

  <dt id="arg-xlab">xlab<a class="anchor" aria-label="anchor" href="#arg-xlab"></a></dt>
<dd><p>Customize x-axis label</p></dd>

  <dt id="arg-ylab">ylab<a class="anchor" aria-label="anchor" href="#arg-ylab"></a></dt>
<dd><p>Customize y-axis label</p></dd>

  <dt id="arg-main">main<a class="anchor" aria-label="anchor" href="#arg-main"></a></dt>
<dd><p>Customize plot title</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to <a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot.default</a></p></dd>

</dl></div>
    <div id="author">
    <h2>Author</h2>
    <p>Ken Kellner <a href="mailto:contact@kenkellner.com">contact@kenkellner.com</a>.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#Analyze Longley economic data in JAGS</span></span></span>
<span class="r-in"><span><span class="co">#Number employed as a function of GNP</span></span></span>
<span class="r-in"><span><span class="co">#See ?jags for a more detailed example</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Get data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">longley</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gnp</span> <span class="op">&lt;-</span> <span class="va">longley</span><span class="op">$</span><span class="va">GNP</span></span></span>
<span class="r-in"><span><span class="va">employed</span> <span class="op">&lt;-</span> <span class="va">longley</span><span class="op">$</span><span class="va">Employed</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">employed</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>gnp<span class="op">=</span><span class="va">gnp</span>,employed<span class="op">=</span><span class="va">employed</span>,n<span class="op">=</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Identify filepath of model file</span></span></span>
<span class="r-in"><span><span class="va">modfile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Write model</span></span></span>
<span class="r-in"><span><span class="co">#Note calculation of discrepancy stats fit and fit.new</span></span></span>
<span class="r-in"><span><span class="co">#(sums of residuals)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="st">"</span></span></span>
<span class="r-in"><span><span class="st">model{</span></span></span>
<span class="r-in"><span><span class="st"></span></span></span>
<span class="r-in"><span><span class="st">  #Likelihood</span></span></span>
<span class="r-in"><span><span class="st">  for (i in 1:n){ </span></span></span>
<span class="r-in"><span><span class="st"></span></span></span>
<span class="r-in"><span><span class="st">    employed[i] ~ dnorm(mu[i], tau)     </span></span></span>
<span class="r-in"><span><span class="st">    mu[i] &lt;- alpha + beta*gnp[i]</span></span></span>
<span class="r-in"><span><span class="st">    </span></span></span>
<span class="r-in"><span><span class="st">    res[i] &lt;- employed[i] - mu[i]   </span></span></span>
<span class="r-in"><span><span class="st">    emp.new[i] ~ dnorm(mu[i], tau)</span></span></span>
<span class="r-in"><span><span class="st">    res.new[i] &lt;- emp.new[i] - mu[i]</span></span></span>
<span class="r-in"><span><span class="st"></span></span></span>
<span class="r-in"><span><span class="st">  }</span></span></span>
<span class="r-in"><span><span class="st">    </span></span></span>
<span class="r-in"><span><span class="st">  #Priors</span></span></span>
<span class="r-in"><span><span class="st">  alpha ~ dnorm(0, 0.00001)</span></span></span>
<span class="r-in"><span><span class="st">  beta ~ dnorm(0, 0.00001)</span></span></span>
<span class="r-in"><span><span class="st">  sigma ~ dunif(0,1000)</span></span></span>
<span class="r-in"><span><span class="st">  tau &lt;- pow(sigma,-2)</span></span></span>
<span class="r-in"><span><span class="st">  </span></span></span>
<span class="r-in"><span><span class="st">  #Derived parameters</span></span></span>
<span class="r-in"><span><span class="st">  fit &lt;- sum(res[])</span></span></span>
<span class="r-in"><span><span class="st">  fit.new &lt;- sum(res.new[])</span></span></span>
<span class="r-in"><span><span class="st"></span></span></span>
<span class="r-in"><span><span class="st">}</span></span></span>
<span class="r-in"><span><span class="st">"</span>, con<span class="op">=</span><span class="va">modfile</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Set parameters to monitor</span></span></span>
<span class="r-in"><span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'alpha'</span>,<span class="st">'beta'</span>,<span class="st">'sigma'</span>,<span class="st">'fit'</span>,<span class="st">'fit.new'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Run analysis</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="jags.html">jags</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>,</span></span>
<span class="r-in"><span>            inits <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>            parameters.to.save <span class="op">=</span> <span class="va">params</span>,</span></span>
<span class="r-in"><span>            model.file <span class="op">=</span> <span class="va">modfile</span>,</span></span>
<span class="r-in"><span>            n.chains <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>            n.adapt <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>            n.iter <span class="op">=</span> <span class="fl">1000</span>,</span></span>
<span class="r-in"><span>            n.burnin <span class="op">=</span> <span class="fl">500</span>,</span></span>
<span class="r-in"><span>            n.thin <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Processing function input....... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Compiling model graph</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Resolving undeclared variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Allocating nodes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Graph information:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Observed stochastic nodes: 16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Unobserved stochastic nodes: 19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Total graph size: 126</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initializing model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adaptive phase, 100 iterations x 3 chains </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> If no progress bar appears JAGS has decided not to adapt </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Burn-in phase, 500 iterations x 3 chains </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sampling from joint posterior, 500 iterations x 3 chains </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Calculating statistics....... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done. </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Examine output summary</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">out</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> JAGS output for model '/tmp/RtmpWkPEqM/fileaa5643eba4c', generated by jagsUI.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimates based on 3 chains of 1000 iterations,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adaptation = 100 iterations (sufficient),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> burn-in = 500 iterations and thin rate = 2,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> yielding 750 total samples from the joint posterior. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MCMC ran for 0 minutes at time 2026-01-29 15:20:57.214734.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            mean    sd   2.5%    50%  97.5% overlap0     f  Rhat n.eff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha    51.825 0.737 50.315 51.835 53.335    FALSE 1.000 1.000   750</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta      0.035 0.002  0.031  0.035  0.038    FALSE 1.000 1.001   750</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma     0.720 0.158  0.488  0.692  1.076    FALSE 1.000 1.005   750</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit      -0.020 2.932 -5.756 -0.006  5.922     TRUE 0.501 0.999   750</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit.new   0.039 2.871 -5.191 -0.077  6.042     TRUE 0.483 1.006   369</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> deviance 33.338 2.941 30.012 32.466 40.361    FALSE 1.000 1.002   750</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Successful convergence based on Rhat values (all &lt; 1.1). </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rhat is the potential scale reduction factor (at convergence, Rhat=1). </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For each parameter, n.eff is a crude measure of effective sample size. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> overlap0 checks if 0 falls in the parameter's 95% credible interval.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f is the proportion of the posterior with the same sign as the mean;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i.e., our confidence that the parameter is positive or negative.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIC info: (pD = var(deviance)/2) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pD = 4.3 and DIC = 37.664 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIC is an estimate of expected predictive error (lower is better).</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Posterior predictive check plot</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">pp.check</span><span class="op">(</span><span class="va">out</span>, observed <span class="op">=</span> <span class="st">'fit'</span>, simulated <span class="op">=</span> <span class="st">'fit.new'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ppcheck-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.4946667</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://kenkellner.com" class="external-link">Ken Kellner</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

